## 三态 - 超时，重试，接口幂等性
在集中式架构中， 我们调用一个接口返回的结果只有两种， 成功或者失败，但是在分布式领域中，会出现“超时”这个状态。


## 分布式事务 - 最终一致性
分布式情况下，业务原子性操作很可能是跨服务的，这样就导致了分布式事务，

例如 A和 B 操作分别是不同服务下的同一个事务操作内的操作， A 调用 B， A 如果可以清楚的知道 B 是否成功提交从而控制自身的提交还是回滚操作，但是在分布式系统中调用会出现一个新状态就是超时，就是 A 无法知道 B 是成功还是失败，这个时候 A是提交本地事务还是回滚呢？

还有一种解决方案就是重试机制（通过MQ的消息重发功能），
如果第1次调用成功但是没返回结果，那调用方重试发起第2次请求，对于被调用方来说是重复调用，因此需在要写入的接口做幂等设计。

多次调用和单次调用是一样的效果，通常可以设置一个唯一键，在写入的时候查询是否已经存在，避免重复执行写操作。

其实根据 CAP 和 BASE 理论，不可能在高可用分布式情况下做到一致性，一般都是最终一致性保证。


## 一致性 - Zookeeper 
数据被复制到不同的机器上，如何保证各台主机之间的数据副本的一致性将成为一个难点。


## 负载均衡 - Nginx
路由算法很多，有 DNS 路由，如果 session 在本机，还会根据用户 id 或则 cookie 等信息路由到固定的机器，

当然现在应用服务器为了扩展的方便都会设计为无状态的， session 会保存到专有的 session 服务器，所以不会涉及到拿不到 session 问题。

那路由规则是随机获取么？

例如如果为了保证异地多活的多机房，跨机房调用的开销太大，肯定会优先选择同机房的服务，这个
要参考具体的机器分布来考虑。

