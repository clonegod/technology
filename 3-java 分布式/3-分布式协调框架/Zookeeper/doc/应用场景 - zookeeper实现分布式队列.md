##分布式队列
常用的消息队列：activeMQ，kafka

####先进先出队列（任务的有序执行）
如何用zookeeper模拟消息队列：

	1.通过getChildren获取指定根节点下的所有子节点，子节点就是任务
	2.确定自己节点在子节点中的顺序
	3.如果自己不是最小的子节点，那么监控比自己小的上一个子节点，否则处于等待
	接收watcher通知，重复流程

####barrier模式/同步队列
线程都达到某个点后，才开始执行任务。

例如有个大任务分解为多个子任务，要所有子任务都完成了才能进入到下一流程。

	根节点下创建临时节点，当子节点个数与指定的COUNT相同时，客户端线程才开始执行。
	当一个队列的成员都聚齐时，这个队列才可用，否则一直等待所有成员到达。
	

####小心：
根据Netflix的Curator作者所说， ZooKeeper真心不适合做Queue，或者说ZK没有实现一个好的Queue。

原因有五：

  1. ZK有1MB 的传输限制。 实践中ZNode必须相对较小，而队列包含成千上万的消息，非常的大。
  2. 如果有很多节点，ZK启动时相当的慢。 而使用queue会导致好多ZNode. 你需要显著增大 initLimit 和 syncLimit.
  3. ZNode很大的时候很难清理。Netflix不得不创建了一个专门的程序做这事。
  4. 当大量的包含成千上万的子节点的ZNode时， ZK的性能变得不好
  5. ZK的数据库完全放在内存中。 大量的Queue意味着会占用很多的内存空间。
